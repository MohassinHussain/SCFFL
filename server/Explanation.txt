# System Intelligence: LSTM Models & Real-Time Validation

This document explains the architecture of the SCFFL Analysis Engine, which combines Historical Deep Learning (LSTM) with Real-Time Validation APIs.

## 1. Core Architecture

The system uses a hybrid approach:
-   **Predictive Layer (LSTM)**: Uses historical dataset trained models to forecast future conditions.
-   **Validation Layer (Real-Time APIs)**: Uses current live data (TomTom, Open-Meteo) to benchmark the model predictions and calculate accuracy scores dynamically.

## 2. LSTM Models (Predictive Layer)

### Traffic Analysis Model (`traffic_analyzer.py`)
-   **Architecture**: Long Short-Term Memory (LSTM) Recurrent Neural Network.
-   **Input Features**: Route Name, Hour of Day, Day of Week, Season, Peak Hour Status, Range (km).
-   **Output**: Traffic Index (0-100 scale representing congestion).
-   **Dataset**: `hyderabad_traffic_data.csv` (Historical traffic flows).
-   **Purpose**: To predict congestion levels even for future dates/times where real-time data isn't available, and to understand patterns.

### Weather Analysis Model (`weather_analyzer.py`)
-   **Architecture**: LSTM Network.
-   **Input Features**: Location, Hour, Season.
-   **Output**: Rain (mm) and Temperature (Â°C).
-   **Dataset**: `hyderabad_hourly_weather_data.csv`.
-   **Purpose**: Logistics planning moves based on weather forecasts.

## 3. Real-Time Validation Layer (Ground Truth)

To ensure trust in the AI models, we compare every prediction against live "Ground Truth" data when available.

### TomTom Traffic & Routing API
-   **Usage**: Fetches the *actual* current travel time and traffic delays for the requested route.
-   **Endpoint**: `api.tomtom.com/routing/1/calculateRoute/...`
-   **Metric**: `travelTimeInSeconds`, `trafficDelayInSeconds`.
-   **Validation**: Comparing LSTM-estimated Delivery Time vs. TomTom's precise live Travel Time.

### Open-Meteo Weather API
-   **Usage**: Fetches current `temperature_2m` and `precipitation`.
-   **Endpoint**: `api.open-meteo.com/v1/forecast...`
-   **Validation**: Verifying if the LSTM correctly predicted rain/conditions.

## 4. Accuracy Calculation

When a user requests a prediction on the "Overall" page:
1.  **Prediction**: LSTM runs and estimates delivery time (e.g., 45 mins) based on historical patterns.
2.  **Live Check**: System queries TomTom for the same route (e.g., 42 mins actual).
3.  **Scoring**:
    -   `Time Accuracy % = 100 - (|Pred - Actual| / Actual * 100)`
    -   Example: `100 - (|45 - 42|/42 * 100) = 92.8% Accuracy`

## 5. Value Proposition

This architecture allows SCFFL to:
-   **Plan Future Logistics**: Use LSTM for tomorrow's planning (where TomTom can't see).
-   **Calibrate in Real-Time**: Use today's API data to continuously measure and display how well the models are performing.
